---
title: "makeExp1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

### Creates simulated data and saves expression matrix, trueH, trueW, and unmixed data to exp1.RData

#### Creates simulated data with 3 compartments, sample size = 50, noise_setting = 10
```{r}
load("~/Desktop/stonybrook/simons/moffitt/src/pdac/data/A.RData")
load("~/Desktop/stonybrook/simons/moffitt/src/pdac/data/mu.RData")

Samplesize = 50
scaleFactor = rep(30, 2)
noise_setting = 0
d.params = c("Tumor"   = .3,
             "Stromal" = .5,
             "Normal"  = .2)
sim.data <- Complete_simulation(A_tumor = A,
                               mu_tumor = mu, 
                               Samplesize = Samplesize,
                               scaleFactor = scaleFactor,
                               d.params = d.params,
                               noise_setting = noise_setting,
                               seed = 1234)
names(sim.data) = c("Y", "W", "H", "Wi", "pureExample1", "pureExample2")
```

#### Obtains expression matrix with mixture data, trueW, trueH, signature matrices 
```{r}
ex <- sim.data[[1]]
meanW <- sim.data[[2]]
trueH <- sim.data[[3]]
trueW <- sim.data[[4]]

experiment1 <- list()
experiment1$ex <- ex
experiment1$trueW <- trueW
experiment1$trueH <- trueH
experiment1$unmixed <- meanW
```

#### Saves experiment1 data to .RData file
```{r}
save(experiment1, file = "/Users/anandbanwasi/Desktop/stonybrook/simons/moffitt/src/pdac/data/exp1_medium_noise.RData")
```